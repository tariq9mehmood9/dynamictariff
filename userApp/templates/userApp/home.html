{% extends 'base_layout.html' %}

{% block title %}
Dynamic Tariff
{% endblock title %}

{% load static %}
{% block content %}

    <nav class="nav-menu d-none d-lg-block">
      <ul>
        <li class="active"><a href="{% url 'baseApp:home' %}">Home</a></li>
        <li><a href="{% url 'baseApp:about' %}">Team</a></li>
        <li><a href="{% url 'baseApp:abstract' %}">Abstract</a></li>
        <li><a href="#">Pricing</a></li>
        <li class="drop-down"><a href="#">Drop Down</a>
          <ul>
            <li><a href="#">Drop Down 1</a></li>
            <li><a href="#">Drop Down 2</a></li>
          </ul>
        </li>
        <li><a href="#">Contact</a></li>
      </ul>
    </nav>
    
    {% if user.is_authenticated %}
    <a href="{% url 'accounts:logout' %}" class="get-started-btn">Sign out</a>
    <!-- <img class="rounded-circle article-img" src="{{ request.user.profile.image.url }}" id="img">  -->
    {% else %}
    <a href="{% url 'accounts:login' %}" class="sign-in-btn">Sign in</a>
    <a href="{% url 'accounts:register' %}" class="get-started-btn">Sign up</a>
    {% endif %}
  </div>
</header>

<div class="container">

  <br>
  <!-- <div class="alert alert-success" role="alert"> -->
    <!-- <h4 class="alert-heading">Welcome {{user.first_name}} &#128515,</h4> -->
    <!-- <p></p>
    <hr>
    <p class="mb-0"><i class="icofont-info-circle"></i> Please note that our system updates the data only when a load is changed with a minimum interval of 1 minute.</p> -->
  <!-- </div> -->
  {% include 'accounts/_flash_messages.html'%}

  <div class="row justify-content-center">
    <div class="col-lg-6">
      <div class="card">
          <div class="card-body">
              <canvas id="loadType"></canvas>
          </div>
      </div>
    </div>
    <div class="col-lg-6">
        <div class="card">
            <div class="card-body">
                <canvas id="unitPrice"></canvas>
            </div>
        </div>
    </div>
  </div>

  <br><br>
  
  <div class="row justify-content-center">
    <div class="col-lg-6">
      <div class="card">
          <div class="card-body">
              <canvas id="loadCurve"></canvas>
          </div>
      </div>
    </div>
    <div class="col-lg-6">
      <div class="card">
          <div class="card-body">
              <canvas id="dispatchData"></canvas>
          </div>
      </div>
    </div>
  </div>

  <br><br>
    
  <div class="row justify-content-center">
    <div class="col">
      <div class="card">
          <div class="card-body">
              <canvas id="relComp"></canvas>
          </div>
      </div>
    </div>
  </div>

  <br><br>
  
  <div class="row justify-content-center">
    <div class="col-lg-6">
        <div class="">
            <div class="">
                <canvas id="loadType"></canvas>
            </div>
        </div>
    </div>
  </div>

  <br><br>
  
</div>

{% endblock content %}
    

{% block script %}
<script>
  // loadCurve
  $(document).ready(function(){
    var ctx = document.getElementById('loadCurve').getContext('2d');
    Chart.defaults.global.animation.duration = 1500;
    Chart.defaults.global.legend.display = false;
    Chart.defaults.global.tooltips.displayColors = false;
    Chart.defaults.global.title.text = 'Cummulative Load Curve'; 
    Chart.defaults.global.title.display = true;
    Chart.defaults.scale.gridLines.color = 'rgba(0, 0, 0, 0.05)';
    var myChart = new Chart(ctx, {
      type: 'line',
      data: {
          labels: [{% for i in n24 %} {{i}},{% endfor %}],
          datasets: [{

            backgroundColor: 'rgba(97, 207, 128, 0.4)',
            hoverBackgroundColor: 'rgba(97, 207, 128, 1)',
            borderColor: 'rgba(97, 207, 128, 01)',
            borderWidth: 1,

              data: [{% for item in loadCurve %} {{item}},{% endfor %}],
          }]
      },
      options: {
          scales: {
              yAxes: [{
                scaleLabel: {
                  display: true,
                  labelString: 'Load(MW)'
                },
                ticks: {
                    beginAtZero: true
                  }
              }],
              xAxes: [{
                scaleLabel: {
                  display: true,
                  labelString: 'Time(Hr)'
                }
              }]
          }
      }
    });
  });
  // unitPrice
  $(document).ready(function(){
    var ctx = document.getElementById('unitPrice').getContext('2d');
    Chart.defaults.global.animation.duration = 1500;
    Chart.defaults.global.legend.display = false;
    Chart.defaults.global.tooltips.displayColors = false;
    Chart.defaults.global.title.text = 'Dynamic Unit Price'; 
    Chart.defaults.global.title.display = true;
    Chart.defaults.scale.gridLines.color = 'rgba(0, 0, 0, 0.05)';
    var myChart = new Chart(ctx, {
      type: 'bar',
      data: {
          labels: [{% for i in n24 %} {{i}},{% endfor %}],
          datasets: [{

            backgroundColor: 'rgba(97, 207, 128, 0.4)',
            hoverBackgroundColor: 'rgba(97, 207, 128, 1)',
            borderColor: 'rgba(97, 207, 128, 01)',
            borderWidth: 1,

              data: [{% for item in unitPrice %} {{item}},{% endfor %}],
          }]
      },
      options: {
          scales: {
              yAxes: [{
                scaleLabel: {
                  display: true,
                  labelString: 'Cost (Rs/kWh)'
                },
                ticks: {
                    beginAtZero: true
                  }
              }],
              xAxes: [{
                scaleLabel: {
                  display: true,
                  labelString: 'Time(Hr)'
                }
              }]
          }
      }
    });
  });
  // dispatchData
  $(document).ready(function(){
    var ctx = document.getElementById('dispatchData').getContext('2d');
    Chart.defaults.global.animation.duration = 1500;
    Chart.defaults.global.legend.display = true;
    Chart.defaults.global.tooltips.displayColors = true;
    Chart.defaults.global.title.text = 'Source-Wise Generation'; 
    Chart.defaults.global.title.display = true;
    Chart.defaults.scale.gridLines.color = 'rgba(0, 0, 0, 0.05)';
    var chart = new Chart(ctx, {
   type: 'bar',
   data: {
      labels: [{% for i in n24 %} {{i}}, {% endfor %}],
      datasets: [
        {
         label: 'Thermal',
         data: [{% for i in dispatchThermal %} {{i}}, {% endfor %}],
         backgroundColor: '#DB4437'
      }, {
         label: 'Solar',
         data: [{% for i in dispatchSolar %} {{i}}, {% endfor %}],
         backgroundColor: '#F4B400'
      }, {
         label: 'Hydel',
         data: [{% for i in dispatchHydel %} {{i}}, {% endfor %}],
         backgroundColor: '#4285F4'
      }]
   },
   options: {
      responsive: true,
      legend: {
         position: 'top'
      },
      scales: {
         xAxes: [{
            stacked: true
         }],
         yAxes: [{
            stacked: true
         }]
      }
   }
});
  });
  // loadType
  $(document).ready(function(){
    var ctx = document.getElementById('loadType').getContext('2d');
    Chart.defaults.global.animation.duration = 1500;
    Chart.defaults.global.legend.display = true;
    Chart.defaults.global.tooltips.displayColors = true;
    Chart.defaults.global.title.text = 'Category-Wise Load'; 
    Chart.defaults.global.title.display = true;
    var myChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: ['Residential', 'Commercial', 'Industrial'],
            datasets: [{
              backgroundColor: ['rgba(15,157,88,0.6)', 'rgba(219,68,55,0.6)', 'rgba(66,133,244,0.6)'],
              hoverBackgroundColor: ['rgba(15,157,88,1)', 'rgba(219,68,55,1)', 'rgba(66,133,244,1)'],
              borderColor: ['rgba(15,157,88,1)', 'rgba(219,68,55,1)', 'rgba(66,133,244,1)'],
              borderWidth: 0.5,

              data: [{% for item in loadType %} {{item|floatformat:2}},{% endfor %}],
            }]
        },
    });
  });
  // relComp
  $(document).ready(function(){
    var ctx = document.getElementById('relComp').getContext('2d');
    Chart.defaults.global.animation.duration = 1500;
    Chart.defaults.global.legend.display = true;
    Chart.defaults.global.tooltips.displayColors = true;
    Chart.defaults.global.title.text = 'Relative Bill Comparison'; 
    Chart.defaults.global.title.display = true;
    Chart.defaults.scale.gridLines.color = 'rgba(0, 0, 0, 0.05)';
    var myChart = new Chart(ctx, {
      type: 'bar',
      data: {
          labels: ['Residential 1', 'Residential 2', 'Residential 3', 'Residential 4', 'Commercial 1', 'Commercial 2', 'Commercial 3', 'Commercial 4', 'Commercial 5', 'Industrial 1', 'Industrial 2', 'Industrial 3'],
          datasets: [
              {
              label: 'Block Rate Tariff',
              data: [{% for i in brt %} {{i}}, {% endfor %}],
              backgroundColor: 'rgba(219,68,55,0.6)',
              hoverBackgroundColor: 'rgba(219,68,55,1)'
            }, {
              label: 'Dynamic Tariff',
              data: [{% for i in dt %} {{i}}, {% endfor %}],
              backgroundColor: 'rgba(66,133,244,0.6)',
              hoverBackgroundColor: 'rgba(66,133,244,1)'
            }, {
              label: 'User Adapts to Dynamic Tariff',
              data: [{% for i in adt %} {{i}}, {% endfor %}],
              backgroundColor: 'rgba(15,157,88,0.6)',
              hoverBackgroundColor: 'rgba(15,157,88,1)'
            }
          ]
      },
      options: {
          scales: {
              yAxes: [{
                scaleLabel: {
                  display: true,
                  labelString: 'Percentage'
                },
                ticks: {
                    beginAtZero: true
                  }
              }],
              xAxes: [{
                scaleLabel: {
                  display: false,
                  labelString: 'Category'
                }
              }]
          }
      }
    });
  });
  </script>
{% endblock script %}
  